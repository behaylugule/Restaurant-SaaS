{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/behaylu/Documents/project/upwork/postwork/restaurantSaaS/frontend/app/%28client%29/%5BrestaurantId%5D/chat/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { useParams, useRouter } from \"next/navigation\";\nimport { MessageType } from \"@/type/message.model\";\nimport { chatService } from \"@/lib/services/chatService\";\nexport default function ChatRoomPage() {\n  const params = useParams();\n  const roomId = params.restaurantId;\n  const [messages, setMessages] = useState<MessageType[]>([]);\n  const [input, setInput] = useState(\"\");\n\n  //   const accessToken = localStorage.getItem(\"access\");\n  const socketRef = useRef<WebSocket | null>(null);\n  useEffect(() => {\n    console.log(roomId);\n    if (!roomId) return;\n    console.log(roomId);\n    const accessToken = localStorage.getItem(\"access\");\n    socketRef.current = new WebSocket(\n      `ws://localhost:8000/ws/chat/${roomId}/?token=${accessToken}`,\n    );\n\n    console.log(socketRef.current);\n    socketRef.current.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      setMessages((prev) => [...prev, data]);\n    };\n\n    return () => {\n      if (socketRef.current) {\n        socketRef.current.close();\n      }\n    };\n  }, []);\n\n  const sendMessage = () => {\n    console.log(socketRef.current);\n    if (!socketRef.current) return;\n    if (input.trim() && socketRef.current.readyState == WebSocket.OPEN) {\n      socketRef.current.send(JSON.stringify({ text: input }));\n      setMessages((prev) => [...prev, { sender: \"You\", text: input }]);\n    }\n  };\n\n  return (\n    <div className=\"p-6\">\n      <h1>Chat with Restaurant</h1>\n      <div className=\"h-96 overflow-y-scroll border p-4 rounded bg-gray-100 mb-4\">\n        {messages.map((msg, idx) => (\n          <div\n            key={idx}\n            className={msg.sender === \"You\" ? \"text-right\" : \"text-left\"}\n          >\n            <div className=\"inline-block px-3 py-2 rounded bg-white shadow mb-2\">\n              <strong>{msg.sender}</strong>\n              {msg.text}\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"flex gap-2\">\n        <input\n          className=\"flex-1 border p-2 rounded\"\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\n        />\n        <button\n          className=\"bg-blue-500 text-white px-4 rounded\"\n          onClick={sendMessage}\n        >\n          Send\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":";;;;AACA;AACA;;;AAFA;;;AAKe,SAAS;;IACtB,MAAM,SAAS,CAAA,GAAA,qIAAA,CAAA,YAAS,AAAD;IACvB,MAAM,SAAS,OAAO,YAAY;IAClC,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAiB,EAAE;IAC1D,MAAM,CAAC,OAAO,SAAS,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAEnC,wDAAwD;IACxD,MAAM,YAAY,CAAA,GAAA,6JAAA,CAAA,SAAM,AAAD,EAAoB;IAC3C,CAAA,GAAA,6JAAA,CAAA,YAAS,AAAD;kCAAE;YACR,QAAQ,GAAG,CAAC;YACZ,IAAI,CAAC,QAAQ;YACb,QAAQ,GAAG,CAAC;YACZ,MAAM,cAAc,aAAa,OAAO,CAAC;YACzC,UAAU,OAAO,GAAG,IAAI,UACtB,AAAC,+BAA+C,OAAjB,QAAO,YAAsB,OAAZ;YAGlD,QAAQ,GAAG,CAAC,UAAU,OAAO;YAC7B,UAAU,OAAO,CAAC,SAAS;0CAAG,CAAC;oBAC7B,MAAM,OAAO,KAAK,KAAK,CAAC,MAAM,IAAI;oBAClC;kDAAY,CAAC,OAAS;mCAAI;gCAAM;6BAAK;;gBACvC;;YAEA;0CAAO;oBACL,IAAI,UAAU,OAAO,EAAE;wBACrB,UAAU,OAAO,CAAC,KAAK;oBACzB;gBACF;;QACF;iCAAG,EAAE;IAEL,MAAM,cAAc;QAClB,QAAQ,GAAG,CAAC,UAAU,OAAO;QAC7B,IAAI,CAAC,UAAU,OAAO,EAAE;QACxB,IAAI,MAAM,IAAI,MAAM,UAAU,OAAO,CAAC,UAAU,IAAI,UAAU,IAAI,EAAE;YAClE,UAAU,OAAO,CAAC,IAAI,CAAC,KAAK,SAAS,CAAC;gBAAE,MAAM;YAAM;YACpD,YAAY,CAAC,OAAS;uBAAI;oBAAM;wBAAE,QAAQ;wBAAO,MAAM;oBAAM;iBAAE;QACjE;IACF;IAEA,qBACE,6LAAC;QAAI,WAAU;;0BACb,6LAAC;0BAAG;;;;;;0BACJ,6LAAC;gBAAI,WAAU;0BACZ,SAAS,GAAG,CAAC,CAAC,KAAK,oBAClB,6LAAC;wBAEC,WAAW,IAAI,MAAM,KAAK,QAAQ,eAAe;kCAEjD,cAAA,6LAAC;4BAAI,WAAU;;8CACb,6LAAC;8CAAQ,IAAI,MAAM;;;;;;gCAClB,IAAI,IAAI;;;;;;;uBALN;;;;;;;;;;0BAWX,6LAAC;gBAAI,WAAU;;kCACb,6LAAC;wBACC,WAAU;wBACV,OAAO;wBACP,UAAU,CAAC,IAAM,SAAS,EAAE,MAAM,CAAC,KAAK;wBACxC,WAAW,CAAC,IAAM,EAAE,GAAG,KAAK,WAAW;;;;;;kCAEzC,6LAAC;wBACC,WAAU;wBACV,SAAS;kCACV;;;;;;;;;;;;;;;;;;AAMT;GAxEwB;;QACP,qIAAA,CAAA,YAAS;;;KADF","debugId":null}}]
}