{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file:///home/behaylu/Documents/project/upwork/postwork/restaurantSaaS/frontend/lib/services/chatService.ts"],"sourcesContent":["import axios from '../axios'\n\n\nexport const chatService =  {\n  getMessages,\n  getChatRooms\n}\n\nasync function getMessages(data:{page:number,page_size?:number,search?:string, room_id?:string}){\n    return axios.get('/messages/',{params:{\n        ...data\n    }})\n}\n\nasync function getChatRooms(data:{page:number,page_size?:number, search?:string,shop_id?:string}){\n  return axios.get('/chat-rooms/',{\n    params:{\n      ...data\n    }\n  })\n}"],"names":[],"mappings":";;;AAAA;;AAGO,MAAM,cAAe;IAC1B;IACA;AACF;AAEA,eAAe,YAAY,IAAoE;IAC3F,OAAO,+GAAA,CAAA,UAAK,CAAC,GAAG,CAAC,cAAa;QAAC,QAAO;YAClC,GAAG,IAAI;QACX;IAAC;AACL;AAEA,eAAe,aAAa,IAAoE;IAC9F,OAAO,+GAAA,CAAA,UAAK,CAAC,GAAG,CAAC,gBAAe;QAC9B,QAAO;YACL,GAAG,IAAI;QACT;IACF;AACF","debugId":null}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///home/behaylu/Documents/project/upwork/postwork/restaurantSaaS/frontend/hook/usePagination.ts"],"sourcesContent":["import { useState, useMemo } from 'react';\n\nexport function usePagination() {\n    // Define available page sizes\n    const page_sizes = [10, 20, 30, 40, 50];\n\n    // State for current page, initialized to 1\n    const [page, setPage] = useState(1);\n    const [search,setSearch] = useState('')\n    // State for total count of items, initialized to 0\n    const [totalCount, setTotalCount] = useState(0);\n    // State for the number of items per page, initialized to 2\n    const [pageSize, setPageSize] = useState(page_sizes[0] || 10); // Default to the first page size or 10\n\n    // Calculate total pages dynamically\n    const totalPages = useMemo(() => {\n        if (pageSize === 0) return 0; // Avoid division by zero\n        return Math.ceil(totalCount / pageSize);\n    }, [totalCount, pageSize]);\n\n    // Handles moving to the next page\n    const handleNextPage = () => {\n        // Only proceed if the current page is less than the total number of pages\n        if (page < totalPages) {\n            setPage(prevPage => prevPage + 1);\n        }\n    };\n\n    // Handles moving to the previous page\n    const handlePrevPage = () => {\n        // Only proceed if the current page is greater than 1\n        if (page > 1) {\n            setPage(prevPage => prevPage - 1);\n        }\n    };\n\n    return {\n        page,\n        totalCount,\n        setPage,\n        setTotalCount,\n        handleNextPage,\n        handlePrevPage,\n        page_sizes,\n        pageSize, // Renamed to pageSize for consistency\n        setPageSize,\n        totalPages, // Expose totalPages for convenience\n        search,\n        setSearch\n    };\n}"],"names":[],"mappings":";;;AAAA;;;AAEO,SAAS;;IACZ,8BAA8B;IAC9B,MAAM,aAAa;QAAC;QAAI;QAAI;QAAI;QAAI;KAAG;IAEvC,2CAA2C;IAC3C,MAAM,CAAC,MAAM,QAAQ,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACjC,MAAM,CAAC,QAAO,UAAU,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IACpC,mDAAmD;IACnD,MAAM,CAAC,YAAY,cAAc,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE;IAC7C,2DAA2D;IAC3D,MAAM,CAAC,UAAU,YAAY,GAAG,CAAA,GAAA,6JAAA,CAAA,WAAQ,AAAD,EAAE,UAAU,CAAC,EAAE,IAAI,KAAK,uCAAuC;IAEtG,oCAAoC;IACpC,MAAM,aAAa,CAAA,GAAA,6JAAA,CAAA,UAAO,AAAD;6CAAE;YACvB,IAAI,aAAa,GAAG,OAAO,GAAG,yBAAyB;YACvD,OAAO,KAAK,IAAI,CAAC,aAAa;QAClC;4CAAG;QAAC;QAAY;KAAS;IAEzB,kCAAkC;IAClC,MAAM,iBAAiB;QACnB,0EAA0E;QAC1E,IAAI,OAAO,YAAY;YACnB,QAAQ,CAAA,WAAY,WAAW;QACnC;IACJ;IAEA,sCAAsC;IACtC,MAAM,iBAAiB;QACnB,qDAAqD;QACrD,IAAI,OAAO,GAAG;YACV,QAAQ,CAAA,WAAY,WAAW;QACnC;IACJ;IAEA,OAAO;QACH;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;IACJ;AACJ;GAhDgB","debugId":null}},
    {"offset": {"line": 111, "column": 0}, "map": {"version":3,"sources":["file:///home/behaylu/Documents/project/upwork/postwork/restaurantSaaS/frontend/lib/services/shopsService.ts"],"sourcesContent":["import { ShopType } from \"@/type/shops.model\";\nimport axios from \"../axios\";\n\nexport const shopService = {\n\n    getShops,\n    getShop,\n    addShop,\n    updateShop,\n    deleteShop,\n    getShopsForClient\n\n}\n\n\nasync function getShops({page,page_size,search}:{page:number,page_size:number,search:string}){\n    return await axios.get('/shops/',{params:{page,page_size,search}})\n}\n;\nasync function getShop(id:string){\n    return await axios.get(`/shops/${id}/`)\n}\n\nasync function addShop(data:ShopType){\n    return await axios.post('/shops/', data)\n}\n\nasync function updateShop(data:ShopType) {\n  return await axios.patch(`/shops/${data.id}/`,data)    \n}\n\nasync function  deleteShop(id:string) {\n    return await axios.delete(`/shops/${id}/`)\n    \n}\n\nasync function getShopsForClient({page,page_size,search}:{page:number,page_size:number,search:string}) {\n       return await axios.get('/client/shops/',{params:{page,page_size,search}})\n}"],"names":[],"mappings":";;;AACA;;AAEO,MAAM,cAAc;IAEvB;IACA;IACA;IACA;IACA;IACA;AAEJ;AAGA,eAAe,SAAS,KAAoE;QAApE,EAAC,IAAI,EAAC,SAAS,EAAC,MAAM,EAA8C,GAApE;IACpB,OAAO,MAAM,+GAAA,CAAA,UAAK,CAAC,GAAG,CAAC,WAAU;QAAC,QAAO;YAAC;YAAK;YAAU;QAAM;IAAC;AACpE;AAEA,eAAe,QAAQ,EAAS;IAC5B,OAAO,MAAM,+GAAA,CAAA,UAAK,CAAC,GAAG,CAAC,AAAC,UAAY,OAAH,IAAG;AACxC;AAEA,eAAe,QAAQ,IAAa;IAChC,OAAO,MAAM,+GAAA,CAAA,UAAK,CAAC,IAAI,CAAC,WAAW;AACvC;AAEA,eAAe,WAAW,IAAa;IACrC,OAAO,MAAM,+GAAA,CAAA,UAAK,CAAC,KAAK,CAAC,AAAC,UAAiB,OAAR,KAAK,EAAE,EAAC,MAAG;AAChD;AAEA,eAAgB,WAAW,EAAS;IAChC,OAAO,MAAM,+GAAA,CAAA,UAAK,CAAC,MAAM,CAAC,AAAC,UAAY,OAAH,IAAG;AAE3C;AAEA,eAAe,kBAAkB,KAAoE;QAApE,EAAC,IAAI,EAAC,SAAS,EAAC,MAAM,EAA8C,GAApE;IAC1B,OAAO,MAAM,+GAAA,CAAA,UAAK,CAAC,GAAG,CAAC,kBAAiB;QAAC,QAAO;YAAC;YAAK;YAAU;QAAM;IAAC;AAC9E","debugId":null}},
    {"offset": {"line": 165, "column": 0}, "map": {"version":3,"sources":["file:///home/behaylu/Documents/project/upwork/postwork/restaurantSaaS/frontend/utils/utils.ts"],"sourcesContent":["\n\n\nexport const params = {\n    page :10,\n    search:''\n}\n\nexport enum USER_ROLE {\n    ADMIN ='admin',\n    ORGANIZATION_ADMIN = 'organization_admin',\n    SHOP_ADMIN = 'shop_admin',\n    CUSTOMER = 'customer',\n    USER = 'user'\n}\n\nexport enum ORDER_STATUS{\n    PENDING ='pending',\n    PROCESSING = 'processing',\n    READY = 'ready',\n    COMPLETED ='completed',\n    CANCLED ='cancled',\n}\n\nexport enum  MESSAGE_SENDER{\n      USER='user',\n      SYSTEM = 'system'\n}\nexport const host = process.env.NEXT_PUBLIC_API_STATIC"],"names":[],"mappings":";;;;;;;AA4BoB;AAzBb,MAAM,SAAS;IAClB,MAAM;IACN,QAAO;AACX;AAEO,IAAA,AAAK,mCAAA;;;;;;WAAA;;AAQL,IAAA,AAAK,sCAAA;;;;;;WAAA;;AAQL,IAAA,AAAM,wCAAA;;;WAAA;;AAIN,MAAM","debugId":null}},
    {"offset": {"line": 208, "column": 0}, "map": {"version":3,"sources":["file:///home/behaylu/Documents/project/upwork/postwork/restaurantSaaS/frontend/app/%28client%29/%5BrestaurantId%5D/chat/page.tsx"],"sourcesContent":["\"use client\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { useParams, useRouter } from \"next/navigation\";\nimport { ChatRoomType, MessageType } from \"@/type/message.model\";\nimport { chatService } from \"@/lib/services/chatService\";\nimport { usePagination } from \"@/hook/usePagination\";\nimport { shopService } from \"@/lib/services/shopsService\";\nimport { ShopType } from \"@/type/shops.model\";\nimport { useAuth } from \"@/components/AuthContext\";\nimport { MESSAGE_SENDER } from \"@/utils/utils\";\nimport { timeAgo } from \"@/lib/utils\";\n\nexport default function ChatRoomPage() {\n  const params = useParams();\n  const roomId = params.restaurantId;\n  const [messages, setMessages] = useState<MessageType[]>([]);\n  const [input, setInput] = useState(\"\");\n  const pagination = usePagination();\n  const [shopDetail, setShopDetail] = useState<ShopType>();\n  const [chatRoomDetail, setChatRoomDetail] = useState<ChatRoomType>();\n  const { user } = useAuth();\n\n  //   const accessToken = localStorage.getItem(\"access\");\n  const socketRef = useRef<WebSocket | null>(null);\n  useEffect(() => {\n    if (!chatRoomDetail?.id) return;\n\n    const accessToken = localStorage.getItem(\"access\");\n    socketRef.current = new WebSocket(\n      `ws://localhost:8000/ws/chat/${chatRoomDetail.id}/?token=${accessToken}`,\n    );\n\n    console.log(socketRef.current);\n    socketRef.current.onmessage = (event) => {\n      const data = JSON.parse(event.data);\n      console.log(data);\n      data.create_date = Date.now();\n      setMessages((prev) => [...prev, data]);\n    };\n\n    return () => {\n      if (socketRef.current) {\n        socketRef.current.close();\n      }\n    };\n  }, [chatRoomDetail]);\n\n  const sendMessage = () => {\n    console.log(socketRef.current);\n    if (!socketRef.current) return;\n    if (input.trim() && socketRef.current.readyState == WebSocket.OPEN) {\n      socketRef.current.send(\n        JSON.stringify({\n          sender: MESSAGE_SENDER.USER,\n          username: user.username,\n          text: input,\n        }),\n      );\n      //   setMessages((prev) => [\n      //     ...prev,\n      //     { sender: MESSAGE_SENDER.USER, username: user.username, text: input },\n      //   ]);\n    }\n  };\n\n  const getMessages = () => {\n    if (!chatRoomDetail?.id) return;\n\n    chatService\n      .getMessages({\n        page: pagination.page,\n        search: pagination.search,\n        page_size: 100,\n        room_id: chatRoomDetail.id,\n      })\n      .then((res) => {\n        setMessages(res.data.data.results);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n\n  const getShop = () => {\n    if (!roomId) return;\n    shopService\n      .getShop(roomId.toLocaleString())\n      .then((res) => {\n        setShopDetail(res.data.data);\n      })\n      .catch((err) => {});\n  };\n\n  useEffect(() => {\n    getMessages();\n  }, [pagination.page, chatRoomDetail?.id]);\n\n  const paginationRoom = usePagination();\n  const getChatRoom = () => {\n    if (!roomId) return;\n    chatService\n      .getChatRooms({\n        page: paginationRoom.page,\n        page_size: paginationRoom.pageSize,\n        search: paginationRoom.search,\n        shop_id: roomId.toLocaleString(),\n      })\n      .then((res) => {\n        setChatRoomDetail(res.data.data.results[0]);\n        console.log(res.data.data.results[0]);\n      })\n      .catch((err) => {\n        console.log(err);\n      });\n  };\n  useEffect(() => {\n    getChatRoom();\n    getShop();\n  }, []);\n  return (\n    <div className=\" relative\">\n      <div className=\"w-full fixed top-0 bg-[#C71F37] py-4 flex items-center justify-center text-white z-50\">\n        <h1 className=\"font-medium text-[14px]\">\n          Chat with {shopDetail?.name} Manager\n        </h1>\n      </div>\n\n      <div className=\"overflow-y-scroll  border p-4 pb-36 rounded bg-gray-100 mb-4 \">\n        {messages.map((msg, idx) => (\n          <div key={idx}>\n            <div\n              className={`flex flex-col  px-3 py-2  rounded  shadow mb-2 ${\n                msg.sender == MESSAGE_SENDER.USER\n                  ? \"items-end bg-[#C71F37]/10\"\n                  : \"items-start\"\n              }`}\n            >\n              <span\n                className={`font-normal text-[16px] ${\n                  msg.sender == MESSAGE_SENDER.USER ? \"text-right\" : \"text-left\"\n                }`}\n              >\n                {msg.text}\n              </span>\n              <span\n                className={`font-normal text-gray-400 ${\n                  msg.sender == MESSAGE_SENDER.USER ? \"text-right\" : \"text-left\"\n                }`}\n              >\n                {timeAgo(msg.create_date || \"\")}\n              </span>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      <div className=\"fixed bottom-28 flex gap-2 w-full\">\n        <input\n          className=\"flex-1 border-2 p-2 py-4 rounded border-[#C71F37] bg-white outline-none\"\n          value={input}\n          onChange={(e) => setInput(e.target.value)}\n          onKeyDown={(e) => e.key === \"Enter\" && sendMessage()}\n        />\n        <button\n          className=\"bg-[#C71F37] text-white px-4 rounded\"\n          onClick={sendMessage}\n        >\n          Send\n        </button>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}